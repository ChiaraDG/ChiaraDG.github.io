<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chiara Di Gravio">
<meta name="dcterms.date" content="2022-12-31">
<meta name="description" content="A look into extreme weather events registered in the past five years in the US.">

<title>Chiara Di Gravio - An Exploration of Extreme Weather Events in the US</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Chiara Di Gravio</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Education.html">
 <span class="menu-text">Education &amp; Experience</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Publications.html">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Talks.html">
 <span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Projects.html">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ChiaraDG?tab=repositories"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../resume.pdf"><i class="bi bi-person-circle" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/chiara_digravio"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">An Exploration of Extreme Weather Events in the US</h1>
                  <div>
        <div class="description">
          A look into extreme weather events registered in the past five years in the US.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Chiara Di Gravio </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 31, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="the-data" class="level1">
<h1>The Data</h1>
<p>In this blog post we are going to look at severe weather events recorded in the US between 2016 and 2021. The data used in this blog post were downloaded on December 21, 2022 from <a href="https://www.kaggle.com/datasets/sobhanmoosavi/us-weather-events">Kaggle</a>. First, let’s have a quick look at the data. There are approximately 7.5 million of events recorded (7,479,165 to be exact) by 1,973 weather stations across the US and 14 variables. A look into the paper of Moosavi et al linked at the end of this page allows us to understand what each variable represents. Here are the variables we will be looking at:</p>
<ul>
<li><p><em>Type.</em> This is a factor with 7 levels: severe-cold (temperatures <span class="math inline">\(\leq\)</span> 23.7C), fog, hail, rain, snow, storm (this involves rain and winds), and precipitation (anything else that is not classified as rain or snow).</p></li>
<li><p><em>Severity.</em> This is a factor indicating the severity of a weather event. For this analysis we are going to consider only the events classified as heavy or severe.</p></li>
<li><p><em>StartTime(UTC).</em> Date indicating when the event started</p></li>
<li><p><em>TimeZone.</em> This is a factor with 4 levels indicating the US time zones: Eastern, Central, Mountain and Pacific</p></li>
<li><p><em>LocationLat.</em> Latitude</p></li>
<li><p><em>LocationLng.</em> Longitude</p></li>
<li><p><em>City</em></p></li>
<li><p><em>State</em></p></li>
</ul>
</section>
<section id="numbers-and-trends-of-severe-events-across-the-us" class="level1 page-columns page-full">
<h1>Numbers and Trends of Severe Events Across the US</h1>
<p>First, we are going to look at weather trends in the last five years. Of the seven initial types of weather events, there were no severe precipitation and hail events; thus, from now on we will only be looking at cold, fog, rain, snow and storm. For ease of reading the y-axis in the plot we divide the total number of events by 1,000. Here are a couple of interesting things about the plot below:</p>
<ul>
<li><p>Fog was the most common severe events in all of the last five years, followed by extreme cold and rain</p></li>
<li><p>There is a big increase of registered fog events between 2018 and 2019. In the same year, a big decrease in rain event was registered. Wondering if something changed in the classification of events?</p></li>
</ul>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usdata)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"WeatherEvents_Jan2016-Dec2021.csv"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># only take severe events</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>dat.severe <span class="ot">&lt;-</span> dat[Severity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Severe"</span>, <span class="st">"Heavy"</span>)]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create a variable start year</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(dat.severe)[, StartYear <span class="sc">:</span><span class="er">=</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(<span class="st">`</span><span class="at">StartTime(UTC)</span><span class="st">`</span>), <span class="st">"%Y"</span>)]</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create a variable indicating the number of severe events by year. Get the start year</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>events <span class="ot">&lt;-</span> dat.severe[, .(<span class="at">NumEventYearType =</span> .N<span class="sc">/</span><span class="dv">1000</span>), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"StartYear"</span>, <span class="st">"Type"</span>)]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(events, <span class="fu">aes</span>(<span class="at">x =</span> StartYear, <span class="at">y =</span> NumEventYearType, <span class="at">color =</span> Type, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Type, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Number of Events (per 1,000)"</span>, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Number of Severe and Heavy Weather Events Across the US"</span>) <span class="sc">+</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="weather_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">How the number of severe weather events change over time across the US. The number of fog events show a sharp increase between 2018 and 2019. Total number of yearly events was divided by 1,000 for ease of representation.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Next, we are going to add an extra layer to the plot above by looking at weather trends by time zones in the last five years. The drop in the number of rain events we have seen in the plot above was registered in all the time zones but the US Pacific, while we can see that the number of fog events increased in all time zones between 2018 and 2019.</p>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span> dat.severe[, .(<span class="at">NumEventAreaType =</span> .N<span class="sc">/</span><span class="dv">1000</span>), </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                   by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"StartYear"</span>, <span class="st">"Type"</span>, <span class="st">"TimeZone"</span>)]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(area, <span class="fu">aes</span>(<span class="at">x =</span> StartYear, <span class="at">y =</span> NumEventAreaType, <span class="at">color =</span> Type, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(Type<span class="sc">~</span>TimeZone, <span class="at">scale =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Number of Events (per 1,000)"</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Number of Severe an Heavy Weather Events Across the US"</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="weather_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption margin-caption">How the number of severe weather events change over time across the 4 US timezones. Total number of yearly events was divided by 1,000 for ease of representation.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Next, let’s add a finer layer to our plots and map the number of severe events by State and time. In all the plots a dark purple States are those with a lower number of events, while yellow and green States are those with higher number of events.</p>
<p>Starting with fog events it is clear that Texas is the State where most fog events are registered followed by California. Overall, there were not insanely crazy trends, but the number of fog events registered is quite constant across time in each State.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># events by time, type and lat and longitudine</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>events.states <span class="ot">&lt;-</span> dat.severe[, .(<span class="at">NumEventYearType =</span> .N), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                            by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"State"</span>, <span class="st">"StartYear"</span>, <span class="st">"Type"</span>)]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert States abbreviation to complete names</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>events.states<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">tolower</span>(usdata<span class="sc">::</span><span class="fu">abbr2state</span>(events.states<span class="sc">$</span>State))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># map of US states (continguos US only)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>us        <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">map_data</span>(<span class="st">"state"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># merge by state</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>us        <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">inner_join</span>(us, events.states, <span class="at">by =</span> <span class="st">"region"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># function to create the plots</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plot.weather <span class="ot">&lt;-</span> <span class="cf">function</span>(year, type){</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="fu">subset</span>(us, StartYear <span class="sc">==</span> year <span class="sc">&amp;</span> Type <span class="sc">==</span> type)) <span class="sc">+</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> NumEventYearType), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">'cm'</span>))<span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Extreme"</span>, type, <span class="st">"Events Registred in the US in"</span>, year)) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">name =</span> <span class="st">"Number of Events"</span>)   </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>years      <span class="ot">&lt;-</span> <span class="dv">2016</span><span class="sc">:</span><span class="dv">2021</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>event.list <span class="ot">&lt;-</span> <span class="fu">unique</span>(us<span class="sc">$</span>Type)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>p.events   <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(event.list)){</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    p          <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_along</span>(years)){</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        p[[j]] <span class="ot">&lt;-</span> <span class="fu">plot.weather</span>(<span class="at">year =</span> years[j], <span class="at">type =</span> event.list[i])</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    p.events[[i]] <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(p[[<span class="dv">1</span>]], p[[<span class="dv">2</span>]], p[[<span class="dv">3</span>]], </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                               p[[<span class="dv">4</span>]], p[[<span class="dv">5</span>]], p[[<span class="dv">6</span>]], <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>                               <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend=</span><span class="st">"bottom"</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p.events[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="weather_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption margin-caption">Total number of extreme fog events recorded in each US State in the last five years.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Second, let us move to extreme rain. Again the number of rain events are similar within each state across time. It is interesting how little rain California gets compared to the amount of fog. Also, Florida is one of the States where the majority of rain events are recorded. A guess is that hurricane season might have had an impact of this number.</p>
<p><code>{#| fig-width: 10} #| fig-height: 10 #| fig-cap: Total number of extreme rain events recorded in each US State in the last five years. #| cap-location: margin p.events[[2]]</code></p>
<p>Thus, let us look at extreme cold. As expected the States with extreme cold events tend to be those closer to the Canadian border (Michigan and Minnesota stood out from this map).</p>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p.events[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="weather_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption margin-caption">Total number of extreme cold events recorded in each US State in the last five years.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Then comes the snow. There are no extreme snow events recorded in Tennessee in 2017 and in Louisiana in 2018, and like for the extreme cold the northern States are those that record the higher number of events. It is striking, however, how much the number of snow events increase from 2016 to 2021.</p>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>p.events[[<span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="weather_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption margin-caption">Total number of extreme snow events recorded in each US State in the last five years.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Finally, the extreme storms. Here we go back to the trend we have seen for other weather events: the number of extreme storm event does not change within each state across time (with the exception of Texas where the number of extreme storm events increase between 2016 and 2021).</p>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>p.events[[<span class="dv">5</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="weather_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption margin-caption">Total number of extreme storm events recorded in each US State in the last five years.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="which-cities-got-the-worst-weather" class="level1 page-columns page-full">
<h1>Which Cities Got the “Worst” Weather?</h1>
<p>The table below shows the top 10 cities in the US where the highest number of heavy and severe weather events are recorded. This is a top 10 where most of the people might not want to be part of!</p>
<p>There are three cities in Florida in the top 10 (again hurricane might be the big culprit here), but the city the the highest number of recorded severe weather events is Mullan, Idaho.</p>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> dat.severe[, .(<span class="at">NumEventAreaType =</span> .N), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"City"</span>, <span class="st">"State"</span>)]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setorder</span>(cities, <span class="at">cols =</span> <span class="sc">-</span><span class="st">"NumEventAreaType"</span>) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(cities, <span class="dv">10</span>), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"City"</span>, <span class="st">"State"</span>, <span class="st">"Number of Events"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="tbl-worst-city" class="anchored page-columns page-full">
<table class="table table-sm table-striped">

<thead>
<tr class="header">
<th style="text-align: left;">City</th>
<th style="text-align: left;">State</th>
<th style="text-align: right;">Number of Events</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mullan</td>
<td style="text-align: left;">ID</td>
<td style="text-align: right;">4971</td>
</tr>
<tr class="even">
<td style="text-align: left;">Thompson Falls-West End</td>
<td style="text-align: left;">MT</td>
<td style="text-align: right;">4802</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sargents</td>
<td style="text-align: left;">NH</td>
<td style="text-align: right;">4775</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tampa</td>
<td style="text-align: left;">FL</td>
<td style="text-align: right;">4617</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jacksonville</td>
<td style="text-align: left;">FL</td>
<td style="text-align: right;">4588</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Beach</td>
<td style="text-align: left;">OR</td>
<td style="text-align: right;">4394</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lompoc</td>
<td style="text-align: left;">CA</td>
<td style="text-align: right;">4292</td>
</tr>
<tr class="even">
<td style="text-align: left;">Panama City</td>
<td style="text-align: left;">FL</td>
<td style="text-align: right;">4056</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wolf Creek</td>
<td style="text-align: left;">OR</td>
<td style="text-align: right;">3960</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tillamook</td>
<td style="text-align: left;">OR</td>
<td style="text-align: right;">3671</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Table&nbsp;1: Top 10 cities recording extreme evetns</div></div>
</div>
</div>
<p>A short read on the climate Mullan, ID (thanks to Wikipedia) shows that Mullan tend to be really cold and snowy in the winter, nd a quick look at the data shows how 311 extreme snow events were recorded in five years (this is approximately 62 extreme events a year!)</p>
<div class="cell page-columns page-full">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mullan <span class="ot">&lt;-</span> dat.severe[City <span class="sc">==</span> <span class="st">"Mullan"</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mullan[, .(<span class="at">NumEventAreaType =</span> .N), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Type"</span>)],</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Type"</span>, <span class="st">"Number of Events"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<table class="table table-sm table-striped">

<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: right;">Number of Events</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fog</td>
<td style="text-align: right;">4610</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cold</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Snow</td>
<td style="text-align: right;">311</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rain</td>
<td style="text-align: right;">14</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Extreme ecents recorded in Mullan, ID between 2016 and 2021 </div></div>
</div>
</section>
<section id="reference" class="level1">
<h1>Reference</h1>
<p>[1] Moosavi, Sobhan, Mohammad Hossein Samavatian, Arnab Nandi, Srinivasan Parthasarathy, and Rajiv Ramnath. “<a href="https://arxiv.org/abs/1902.06792">Short and Long-term Pattern Discovery Over Large-Scale Geo-Spatiotemporal Data</a>.” In Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, ACM, 2019.</p>
<p>[2] <a href="https://en.wikipedia.org/wiki/Mullan,_Idaho">Wikipedia page on Mullan, ID.</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>